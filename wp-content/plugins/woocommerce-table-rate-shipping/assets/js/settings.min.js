jQuery(document).ready(function(e){if(jQuery("#BETRS-method-options").on("click","a",function(t){t.preventDefault();var s=jQuery(this).attr("class"),n=jQuery(".betrs_settings_section");"expand"==s?n.each(function(t){e(this).find(".betrs_settings_inner").slideDown("fast")}):"collapse"==s&&n.each(function(t){e(this).find(".betrs_settings_inner").slideUp("fast")})}),null!=jQuery("#user_permissions.betrs_settings_section")){var t=jQuery("#user_permissions.betrs_settings_section table tbody tr");switch("everyone"==jQuery("#woocommerce_betrs_shipping_user_limitation").val()&&t.eq(1).css("display","none"),jQuery("#woocommerce_betrs_shipping_user_modification").val()){case"specific-users":t.eq(3).css("display","none");break;case"specific-roles":t.eq(4).css("display","none");break;case"admins":default:t.eq(3).css("display","none"),t.eq(4).css("display","none")}}if(jQuery("#user_permissions.betrs_settings_section").on("change","#woocommerce_betrs_shipping_user_limitation",function(t){t.preventDefault();var s=e(this).val(),n=jQuery("#user_permissions.betrs_settings_section table tbody tr");"everyone"==s?n.eq(1).css("display","none"):n.eq(1).css("display","")}),jQuery("#user_permissions.betrs_settings_section").on("change","#woocommerce_betrs_shipping_user_modification",function(t){t.preventDefault();var s=e(this).val(),n=jQuery("#user_permissions.betrs_settings_section table tbody tr");n.eq(3).css("display","none"),n.eq(4).css("display","none"),"specific-roles"==s?n.eq(3).css("display",""):"specific-users"==s&&n.eq(4).css("display","")}),jQuery(document).on("click","#conditions.betrs_settings_section a.betrs_add_method_cond",function(t){t.preventDefault(),jQuery(this).block({message:null,overlayCSS:{background:"#fff",opacity:.6}});var s=jQuery(this),n=jQuery(this).closest("td").find("table#method_conditions"),i=n.find("tr");if(1==n.length){var r={action:"betrs_add_method_condition",condID:i.length};e.post(ajaxurl,r,function(e){n.append(e),s.find(".blockUI").remove()})}}),jQuery(document).on("change","#conditions.betrs_settings_section select.method_cond",function(t){t.preventDefault();var s=jQuery(this),n=s.closest("tr"),i=s.val();n.block({message:null,overlayCSS:{background:"#fff",opacity:.6}});var r=n.index();console.log(n),console.log(r);var o={action:"betrs_add_method_condition_extras",selected:i,condID:r};e.post(ajaxurl,o,function(e){n.find(".cond_op_extras").length>0?n.find(".cond_op_extras").replaceWith(e):jQuery(s).parent().after(e),jQuery(document).trigger("betrs_update_options"),n.find(".blockUI").remove(),n.trigger("wc-enhanced-select-init"),n.trigger("betrs_update_dateranges")})}),jQuery(document).on("click","#conditions.betrs_settings_section span.betrs_delete_method_cond",function(){return confirm(betrs_data.text_delete_confirmation)&&jQuery(this).closest("tr").remove(),!1}),null!=jQuery("#other.betrs_settings_section")){var s=(t=jQuery("#other.betrs_settings_section table tbody")).find(".per-class-only");"per-class"!=jQuery("#woocommerce_betrs_shipping_condition").val()&&s.each(function(e,t){jQuery(t).closest("tr").css("display","none")})}function n(e){e.hasClass("open")?e.removeClass("open"):e.addClass("open")}function i(){jQuery("");jQuery(".betrs_settings_section .single-row").each(function(e){op_number=e+1,jQuery(this).attr("data-row_id",op_number),jQuery(this).find(".shipping-headline").each(function(){jQuery(this).html(jQuery(this).html().replace(/(\d)+/,op_number))}),jQuery(this).find(".titlewrap input").each(function(){this.name=this.name.replace(/\[\d+\]/,"["+op_number+"]"),0==this.name.search("option_id")&&(this.value=op_number)}),additional_box=jQuery(this).find(".additional-settings"),additional_box.html(additional_box.html().replace(/\[\d+\]/g,"["+op_number+"]")),jQuery(this).find("table.table_rates tbody").children("tr").each(function(e){jQuery(this).find("td:not(:first-child, :last-child)").find("input,textarea,select").each(function(){this.name=this.name.replace(/\[\d+\]/,"["+op_number+"]")})})})}function r(){var e=jQuery(window).height()-180;jQuery(".be-popup-container").css("max-height",e+"px")}jQuery("#general.betrs_settings_section").on("change","#woocommerce_betrs_shipping_condition",function(t){t.preventDefault(),"per-class"==e(this).val()?s.each(function(e,t){jQuery(t).closest("tr").css("display","")}):s.each(function(e,t){jQuery(t).closest("tr").css("display","none")})}),jQuery(".betrs_settings_section").on("click","h3",function(t){t.preventDefault(),n(jQuery(this)),e(this).next(".betrs_settings_inner").slideToggle("fast")}),jQuery(".betrs_settings_section").on("click",".next-link a",function(e){e.preventDefault();var t=jQuery(this).closest(".betrs_settings_inner"),s=jQuery(this).closest(".betrs_settings_section").next(".betrs_settings_section").find(".betrs_settings_inner");n(t.parent().find("h3")),t.slideUp("fast"),n(s.parent().find("h3")),s.slideDown("fast")}),jQuery(".betrs_settings_section").on("change",".operand_selector",function(t){t.preventDefault();var s=e(this).val(),n=jQuery(".volumetric_number").next(".description").find("span"),i=n.html();if("multiply"==s)var r=i.replace("/","x");else r=i.replace("x","/");n.html(r)}),jQuery(".betrs_settings_section").on("click",".betrs-move-option-up",function(e){e.preventDefault();var t=jQuery(this).closest(".single-row"),s=t.prev(".single-row");return 0!==s.length&&(t.insertBefore(s),i()),!1}),jQuery(".betrs_settings_section").on("click",".betrs-move-option-down",function(e){e.preventDefault();var t=jQuery(this).closest(".single-row"),s=t.next(".single-row");return 0!==s.length&&(t.insertAfter(s),i()),!1}),jQuery(".betrs_settings_section").on("click","a.betrs_table_import",function(e){e.preventDefault();var t=jQuery(this).closest(".single-row").find(".wp-list-table.table_rates"),s=jQuery(this).closest(".single-row").attr("data-row_id"),n=t.find("tbody > tr").length;1==n&&t.find("tbody").children("tr:first").hasClass("no-items")&&n--;var i='<div id="betrs-import-table-popup" class="betrs-popup"><div class="be-popup-container add_form" id="betrs-import-table-form"><form method="post" enctype="multipart/form-data"><h3>'+betrs_data.text_importing_table+"</h3><p><span>"+betrs_data.text_importing_csv+'</span></p><input type="hidden" name="option_ID" id="option_ID" value="'+s+'" /><input type="hidden" name="row_ID" id="row_ID" value="'+n+'" /><p><input type="file" name="betrs_import_csv" id="betrs_import_csv" accept=".csv, text/csv, application/vnd.openxmlformats-officedocument.spreadsheetml.sheet, application/vnd.ms-excel" /></p><p><label><input type="checkbox" name="betrs_table_delete" id="betrs_table_delete" />'+betrs_data.text_importing_del+'</label></p><p><input type="submit" name="betrs_table_import" value="'+betrs_data.text_upload+'" class="form_submit" /> <a href="#" class="cancel">'+betrs_data.text_cancel+"</a></p></form></div></div>";jQuery("body").append(i),r()}),jQuery(document).on("submit","#betrs-import-table-form",function(t){t.preventDefault();var s=jQuery(this).find("input#option_ID").val(),n=jQuery(this).find("input#row_ID").val(),i=jQuery("#BETRS-table-rates-parent").find('.single-row[data-row_id="'+s+'"]').find(".wp-list-table.table_rates tbody"),r=jQuery(this).find("input#betrs_table_delete"),o=jQuery(this).find("input#betrs_import_csv");if(o.val()){var a=o[0].files[0],c=jQuery(this);if([".csv","text/csv","application/vnd.openxmlformats-officedocument.spreadsheetml.sheet","application/vnd.ms-excel"].indexOf(a.type)>-1||/(\.csv)$/i.test(a.name)){c.block({message:null,overlayCSS:{background:"#fff",opacity:.6}});var l=new FileReader;l.readAsText(a),l.onload=function(t){r.is(":checked")&&(i.find("tr").remove(),n=0);var o={action:"betrs_import_table",csvFile:t.target.result,optionID:s,rowID:n};e.post(ajaxurl,o,function(t){if(-1!=t.search("<tr"))i.append(t),e(document.body).trigger("wc-enhanced-select-init"),null!=i.find("tr.no-items")&&i.find("tr.no-items").remove(),jQuery("#betrs-import-table-popup").remove();else{var s=c.find("p span");s.text(betrs_data.text_error),s.css("color","#f44336"),c.find(".blockUI").remove()}})}}else jQuery(this).find('input[type="file"]').parent().css("border","1px solid #f44336")}else jQuery(this).find('input[type="file"]').parent().css("border","1px solid #f44336");return!1}),jQuery(window).on("resize",function(){r()}),jQuery(document).on("click",".be-popup-container .cancel",function(){return jQuery(".betrs-popup").remove(),!1})});